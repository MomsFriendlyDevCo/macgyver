!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t=n();for(var r in t)("object"==typeof exports?exports:e)[r]=t[r]}}(this,function(){return function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){"use strict";var r=t(1),o=t(2);e.exports="dragularModule",angular.module("dragularModule",[]).factory("dragularService",o).directive("dragular",r)},function(e,n){"use strict";var t=function(e){return{restrict:"A",link:function(n,t,r){function o(e){try{return JSON.parse(e)}catch(n){return}}var i=n.$eval(r.dragular)||o(r.dragular)||{};r.dragularModel&&(i.containersModel=r.dragularModel,i.scope||(i.scope=n)),r.dragularNameSpace&&(i.nameSpace=r.dragularNameSpace.split(" ")),r.dragularOnInit&&(i.onInit=n.$eval(r.dragularOnInit)),e(t[0],i)}}};t.$inject=["dragularService"],e.exports=t},function(e,n){"use strict";var t={classesCache:{},containersCtx:{},containers:{},mirror:null,source:null,item:null,copy:null,sourceItem:null,sourceModel:null,sourceFilteredModel:null,target:null,targetCtx:null,targetModel:null,lastDropTarget:null,offsetX:null,offsetY:null,moveX:null,moveY:null,offsetXr:null,offsetYb:null,clientX:null,clientY:null,mirrorWidth:null,mirrorHeight:null,initialSibling:null,currentSibling:null,initialIndex:null,currentIndex:null,tempModel:null,dragOverEvents:{},lastElementBehindCursor:null,grabbed:null},r=function(e,n){function r(r,d){function x(){"string"==typeof r?pe=document.querySelectorAll(r):1!==arguments.length||T(r)||angular.isElement(r)||r[0]||(ve=r||{},pe=[]),ge=ve.copyOptions?angular.copy(ve):ve}function M(){var e=angular.extend({},Ce,ge);angular.extend(ge,e),ge.classes&&(e=angular.extend({},xe,ge.classes),angular.extend(ge.classes,e)),ge.eventNames&&(e=angular.extend({},ye,ge.eventNames),angular.extend(ge.eventNames,e))}function I(){h(ge.boundingBox)||(ge.boundingBox=!1),ge.containers&&(pe=ge.containers),ge.containers=o(pe,!1,ge.scope),ge.containersModel=o(ge.containersModel,!0,ge.scope),T(ge.containersFilteredModel)?ge.containersFilteredModel=T(ge.containersFilteredModel[0])?ge.containersFilteredModel:[ge.containersFilteredModel]:ge.containersFilteredModel=[],ge.nameSpace||(ge.nameSpace=["dragularCommon"]),T(ge.nameSpace)||(ge.nameSpace=[ge.nameSpace]),ge.nameSpace.forEach(function(e){t.containers[e]||(t.containers[e]=[],t.containersCtx[e]=[]);for(var n,r=_(ge).length,o=0;o<r;o++){if(n=_(ge)[o],!n)throw new Error("Container element must be defined!");if(t.containers[e].indexOf(n)!==-1)throw new Error("Cannot register container element more than once! Container element: ");t.containers[e].push(n),t.containersCtx[e].push({o:ge,m:ee(ge)[o],fm:ne(ge)[o]})}})}function $(e){var n=e?"off":"on";i(w,n,"mouseup",oe),_(ge).forEach(function(e){i(e,"on","mousedown",A)}),e||angular.forEach(["dragularenter","dragularleave","dragularrelease"],function(e){var n=ge.eventNames[e];t.dragOverEvents[n]||(O.createEvent?(t.dragOverEvents[n]=O.createEvent("HTMLEvents"),t.dragOverEvents[n].initEvent(n,!0,!0)):(t.dragOverEvents[n]=O.createEventObject(),t.dragOverEvents[n].eventType=n))})}function A(e){if(1===u(e)&&!e.metaKey&&!e.ctrlKey){t.moveX=e.clientX,t.moveY=e.clientY;var n=j(e.target);n&&n.item&&(t.grabbed=n,D(),"mousedown"===e.type&&(S(e.target)?e.target.focus():e.preventDefault()))}}function D(e){var n=e?"off":"on";i(w,n,"mousemove",F)}function F(e){if(t.grabbed&&!Me.dragging){if(e.originalEvent&&(e=e.originalEvent),0===u(e))return void oe({});if(!e.clientX||e.clientX!==t.moveX||!e.clientY||e.clientY!==t.moveY){if(he(ge.ignoreInputTextSelection)){var n=b("clientX",e),r=b("clientY",e),o=O.elementFromPoint(n,r);if(S(o))return}var i=t.grabbed;if(D("remove"),H(),R(),L(i),t.item){if(!ge.direction&&E(t.sourceItem)){var a=t.sourceItem.parentNode,l=a.offsetHeight,c=a.offsetWidth,s=t.sourceItem.clientHeight,d=t.sourceItem.clientWidth;ge.direction=l/s<c/d?"horizontal":"vertical"}var f=m(t.sourceItem);t.offsetX=b("pageX",e)-f.left,t.offsetY=b("pageY",e)-f.top,t.clientX=b("clientX",e),t.clientY=b("clientY",e),ge.boundingBox&&(t.offsetXr=b("pageX",e)-f.right,t.offsetYb=b("pageY",e)-f.bottom),e.preventDefault(),k(),y(t.item,ge.classes.transit),t.mirror.style.left=t.clientX-t.offsetX+"px",t.mirror.style.top=t.clientY-t.offsetY+"px",z(e)}}}}function H(e){var n=e?"off":"on";i(w,n,"selectstart",s),i(w,n,"click",s),i(w,n,"touchmove",s)}function j(e){if(!Me.dragging||!t.mirror){for(var n=e;E(e)&&!Z(E(e));){if(ge.invalid(e,n))return;if(e=E(e),!e)return}var r=E(e);if(r&&!ge.invalid(e,n)&&ge.moves(e,r,n,v(e)))return{item:e,source:r}}}function L(e){t.sourceItem=t.item=e.item,t.source=e.source,t.initialSibling=t.currentSibling=v(e.item),he(ge.copy,[e.item,e.source])?(t.item=angular.element(e.item).clone("events"===ge.copy,"events"===ge.copy)[0],t.copy=ge.copy,ge.scope&&ge.scope.$emit(ge.eventNames.dragularcloned,t.item,e.item)):t.copy=!1;var n=_(ge).indexOf(e.source);return t.sourceModel=ee(ge)[n],t.sourceFilteredModel=ne(ge)[n],t.initialIndex=N(e.item,e.source),Me.dragging=!0,ge.scope&&ge.scope.$emit(ge.eventNames.dragulardrag,t.sourceItem,t.source),!0}function P(e){var n=j(e);n&&(t.grabbed=n,D())}function k(){if(!t.mirror){var e=t.sourceItem.getBoundingClientRect();t.mirror=t.sourceItem.cloneNode(!0),t.mirrorWidth=e.width,t.mirrorHeight=e.height,t.mirror.style.width=f(e)+"px",t.mirror.style.height=g(e)+"px",y(t.mirror,ge.classes.mirror),ge.mirrorContainer.appendChild(t.mirror),i(w,"on","mousemove",z),y(O.body,ge.classes.unselectable),i(t.mirror,"on","wheel",de),ge.scope&&ge.scope.$emit(ge.eventNames.dragularcloned,t.mirror,t.sourceItem)}}function R(){Me.dragging&&t.item&&ie(t.item,E(t.item))}function W(){t.grabbed=!1,D("remove"),H("remove")}function z(e){function n(n){function r(r){r.$emit(ge.eventNames["dragular"+n],t.item,t.lastDropTarget,t.source,e)}ge.scope&&r(ge.scope),t.targetCtx&&t.targetCtx.o.scope&&t.targetCtx.o.scope!==ge.scope&&r(t.targetCtx.o.scope),he(ge.removeOnSpill)===!0&&("over"===n?U():q())}if(t.mirror){e.originalEvent&&(e=e.originalEvent),t.clientX=b("clientX",e),t.clientY=b("clientY",e);var r,o,i,a=t.clientX-t.offsetX,l=t.clientY-t.offsetY;ge.boundingBox&&(r=b("pageX",e),o=b("pageY",e),i=m(ge.boundingBox)),ge.lockY||(!ge.boundingBox||r>i.left+t.offsetX&&r<i.right+t.offsetXr?t.mirror.style.left=a+"px":ge.boundingBox&&(r<i.left+t.offsetX?t.mirror.style.left=t.clientX-(r-i.left)+"px":t.mirror.style.left=t.clientX-t.mirrorWidth-(r-i.right)+"px")),ge.lockX||(!ge.boundingBox||o>i.top+t.offsetY&&o<i.bottom+t.offsetYb?t.mirror.style.top=l+"px":ge.boundingBox&&(o<i.top+t.offsetY?t.mirror.style.top=t.clientY-(o-i.top)+"px":t.mirror.style.top=t.clientY-t.mirrorHeight-(o-i.bottom)+"px"));var c=V(t.mirror,t.clientX,t.clientY),u=K(c,t.clientX,t.clientY),s=u!==t.lastDropTarget;if(c!==t.lastElementBehindCursor&&(X(c,t.dragOverEvents.dragularenter,!!u),t.lastElementBehindCursor&&X(t.lastElementBehindCursor,t.dragOverEvents.dragularleave,c),t.lastElementBehindCursor=c),s&&(t.lastDropTarget&&n("out"),t.lastDropTarget=u,n("over")),u===t.source&&t.copy&&!he(ge.copySortSource))return void(E(t.item)&&t.item.parentNode.removeChild(t.item));var d,f=G(u,c);if(null!==f)d=Q(u,f,t.clientX,t.clientY);else{if(he(ge.revertOnSpill)!==!0||t.copy)return void(t.copy&&E(t.item)&&t.item.parentNode.removeChild(t.item));d=t.initialSibling,u=t.source}(null===d&&s||d!==t.item&&d!==v(t.item)&&d!==t.currentSibling)&&(t.currentSibling=d,u.insertBefore(t.item,d),ge.scope&&ge.scope.$emit(ge.eventNames.dragularshadow,t.item,u,e))}}function K(e,n,r){function o(){if(!Z(a))return!1;for(var o,c=G(a,e),u=Q(a,c,n,r),s=J(a,u),d=ge.nameSpace.length;d--;)if(o=ge.nameSpace[d],t.containers[o].indexOf(a)!==-1){l=i(o);break}return t.target=a,!!s||(l||(l=i("dragularCommon")),l&&B(l.o.containersModel)&&(l.m=ee(l.o)[_(l.o).indexOf(a)]),!(l&&l.o.accepts&&!l.o.accepts(t.item,a,t.source,u,t.sourceModel,t.initialIndex))&&(!(ge.isContainer&&ge.isContainerAccepts&&!ge.isContainerAccepts(t.item,a,t.source,u,t.sourceModel,t.initialIndex))&&(!ge.canBeAccepted||ge.canBeAccepted(t.item,a,t.source,u,t.sourceModel,t.initialIndex))))}function i(e){return t.containersCtx[e]&&t.containersCtx[e][t.containers[e].indexOf(a)]}for(var a=e,l=null;a&&!o();)a=E(a);return a&&l&&(t.targetCtx=l),a}function U(){C(t.item,ge.classes.hide)}function q(){Me.dragging&&y(t.item,ge.classes.hide)}function J(e,n){var r=void 0!==n?n:t.mirror?t.currentSibling:v(t.item);return e===t.source&&r===t.initialSibling}function G(e,n){for(var t=n;t!==e&&E(t)!==e;)t=E(t);return t===w?null:t}function Q(e,n,t,r){function o(){var n,o,i,a=e.children.length;for(n=0;n<a;n++){if(o=e.children[n],i=o.getBoundingClientRect(),l&&i.left>t)return o;if(!l&&i.top>r)return o}return null}function i(){var e=n.getBoundingClientRect();return a(l?t>e.left+f(e)/2:r>e.top+g(e)/2)}function a(e){return e?v(n):n}var l="horizontal"===ge.direction;return n!==e?i():o()}function V(e,n,t){var r,o=e||{},i=o.className;return o.className+=" "+ge.classes.hide,r=O.elementFromPoint(n,t),o.className=i,r}function Z(e){if(!e)return!1;if(_(ge).indexOf(e)>-1)return!0;for(var n=ge.nameSpace.length;n--;)if(t.containers[ge.nameSpace[n]].indexOf(e)!==-1)return!0;return ge.isContainer(e)?(t.tempModel=ge.isContainerModel(e),!0):(t.tempModel=null,!1)}function _(e){return te("containers",e)}function ee(e){return te("containersModel",e,!0)}function ne(e){return te("containersFilteredModel",e,!0)}function te(e,n,r){return B(n[e])?o(n[e](n===ge?Me:null,t),r,n.scope):n[e]}function re(e){if(Me.dragging){var n=arguments.length>0?e:he(ge.revertOnSpill),r=E(t.item),o=J(r);o||t.copy||!n||t.source.insertBefore(t.item,t.initialSibling),!t.sourceModel||t.copy||n?ge.scope&&(o||n)&&ge.scope.$emit(ge.eventNames.dragularcancel,t.item,t.source,t.sourceModel,t.initialIndex):ie(t.item,r),(!t.sourceModel||t.copy||n||o)&&le()}}function oe(e){if(W(),Me.dragging){e.originalEvent&&(e=e.originalEvent),t.clientX=b("clientX",e),t.clientY=b("clientY",e);var n=V(t.mirror,t.clientX,t.clientY),r=K(n,t.clientX,t.clientY);r&&(t.copy&&he(ge.copySortSource)||!t.copy||r!==t.source)?ie(t.item,r):he(ge.removeOnSpill)?ae():re(),t.target=null,t.lastElementBehindCursor&&X(t.lastElementBehindCursor,t.dragOverEvents.dragularrelease,n),ge.scope&&ge.scope.$emit(ge.eventNames.dragularrelease,t.item,t.source,e)}}function ie(r,o){function a(){function e(e){J(o)?e.$emit(ge.eventNames.dragularcancel,r,t.source,t.sourceModel,t.initialIndex):e.$emit(ge.eventNames.dragulardrop,r,o,t.source,t.sourceModel,t.initialIndex,t.targetModel,u)}if(_(ge).forEach(function(e){i(e,"off","mousedown",A),i(e,"on","mousedown",A)}),ge.compileItemOnDrop){var a=angular.element(o).scope?angular.element(o).scope():ge.scope;a&&a.$applyAsync(function(){var e=n(t.copy?l.cloneNode(!0):l)(a);r.parentNode===o&&o.removeChild(r),o.insertBefore(e[0],c),le()})}ge.scope&&e(ge.scope),t.targetCtx&&t.targetCtx.o.scope&&t.targetCtx.o.scope!==ge.scope&&e(t.targetCtx.o.scope),ge.compileItemOnDrop||le()}if(!r)return void le();var l=t.sourceItem,c=t.currentSibling,u=N(r,o);t.copy&&o===t.source&&E(r)&&he(ge.copySortSource)&&r.parentNode.removeChild(t.sourceItem),t.sourceModel&&!J(o)?(t.targetCtx&&t.targetCtx.fm&&(u=t.targetCtx.m.indexOf(t.targetCtx.fm[u])),t.sourceFilteredModel&&(t.initialIndex=t.sourceModel.indexOf(t.sourceFilteredModel[t.initialIndex])),e.$applyAsync(function(){t.sourceModel&&(o===t.source?t.sourceModel.splice(u,0,t.sourceModel.splice(t.initialIndex,1)[0]):(t.dropElmModel=t.copy&&!ge.dontCopyModel?angular.copy(t.sourceModel[t.initialIndex]):t.sourceModel[t.initialIndex],t.tempModel?t.targetModel=t.tempModel:t.targetModel=t.targetCtx&&t.targetCtx.m||t.sourceModel,r.parentNode.removeChild(r),t.copy||t.sourceModel.splice(t.initialIndex,1),t.targetModel&&t.targetModel.splice(u,0,t.dropElmModel)),E(r)&&r.parentNode.removeChild(r),a())})):a()}function ae(){if(Me.dragging){var n=E(t.item);n&&n.removeChild(t.item),t.sourceModel&&e.$applyAsync(function(){t.sourceModel.splice(t.initialIndex,1),le()}),ge.scope&&ge.scope.$emit(t.copy?ge.eventNames.dragularcancel:ge.eventNames.dragularremove,t.item,n,t.sourceModel,t.initialIndex),t.sourceModel||le()}}function le(){W(),me(),t.item&&C(t.item,ge.classes.transit),Me.dragging=!1,he(ge.removeOnSpill)===!0&&q(),ge.scope&&(t.lastDropTarget&&ge.scope.$emit(ge.eventNames.dragularout,t.item,t.lastDropTarget,t.source),ge.scope.$emit(ge.eventNames.dragulardragend,t.item)),t.source=t.item=t.sourceItem=t.initialSibling=t.currentSibling=t.sourceModel=null,t.initialIndex=t.currentIndex=t.lastDropTarget=t.tempModel=t.targetModel=null,t.dropElmModel=t.targetCtx=t.copy=t.moveX=t.moveY=null}function ce(){$(!0),se(ge.containers),oe({})}function ue(e,n,r){e&&(n=n||ee(ge)||{},r=r||ne(ge)||{},e=T(e)?e:c(e),e.forEach(function(e){angular.forEach(ge.nameSpace,function(o){if(!(t.containers[o].indexOf(e)>-1)){var a=t.containers[o].push(e)-1;t.containersCtx[o].push({o:ge,m:n[a],fm:r[a]}),i(e,"off","mousedown",A),i(e,"on","mousedown",A)}})}))}function se(n){e.$applyAsync(function(){n=T(n)?n:c(n),n.forEach(function(e){angular.forEach(ge.nameSpace,function(n){var r;r=t.containers[n].indexOf(e),t.containers[n].splice(r,1),t.containersCtx[n].splice(r,1)})})})}function de(e){if(t.target){e.originalEvent&&(e=e.originalEvent);var n=t.target.scrollTop;t.target.scrollTop+=e.deltaY,n!==t.target.scrollTop&&(e.stopPropagation(),e.preventDefault())}}function me(){t.mirror&&(C(O.body,ge.classes.unselectable),i(w,"off","mousemove",z),i(t.mirror,"off","wheel",de),E(t.mirror)&&t.mirror.parentNode.removeChild(t.mirror),t.mirror=null)}function fe(e){o(e,!0,ge.scope)}var ge,pe=r||[],ve=d||{},he=Y,xe={mirror:"gu-mirror",hide:"gu-hide",unselectable:"gu-unselectable",transit:"gu-transit"},ye={dragularenter:"dragularenter",dragularleave:"dragularleave",dragularrelease:"dragularrelease",dragularcloned:"dragularcloned",dragulardrag:"dragulardrag",dragularcancel:"dragularcancel",dragulardrop:"dragulardrop",dragularremove:"dragularremove",dragulardragend:"dragulardragend",dragularshadow:"dragularshadow",dragularover:"dragularover",dragularout:"dragularout"},Ce={copyOptions:!1,classes:xe,eventNames:ye,containers:!1,containersModel:!1,containersFilteredModel:!1,isContainer:a,isContainerModel:p,isContainerAccepts:l,moves:l,accepts:l,canBeAccepted:l,copy:!1,copySortSource:!1,dontCopyModel:!1,invalid:a,revertOnSpill:!1,removeOnSpill:!1,lockX:!1,lockY:!1,boundingBox:!1,mirrorContainer:O.body,ignoreInputTextSelection:!0,compileItemOnDrop:!1,onInit:!1},Me={containers:t.containers,containersCtx:t.containersCtx,sanitizeContainersModel:fe,sanitizeContainers:o,addContainers:ue,removeContainers:se,isContainer:Z,start:P,end:R,cancel:re,remove:ae,destroy:ce,dragging:!1};return x(),M(),I(),$(),ge.onInit&&ge.onInit(Me,ge),Me}function o(e,n,t){if(B(e))return e;if(T(e))return n?T(e[0])?e:[e]:e;if("string"==typeof e&&t){var r=t.$eval(e);return B(r)?r:function(){return t.$eval(e)}}return e?c(e):[]}function i(e,n,t,r){var o={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"},i={mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"},a={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"},l=angular.element(e);if(e.addEventListener){var c={on:"addEventListener",off:"removeEventListener"};e[c[n]](t,r,{passive:!1}),e[c[n]](o[t],r,{passive:!1})}else"undefined"!=typeof navigator&&navigator.pointerEnabled&&i[t]?l[n](i[t],r):"undefined"!=typeof navigator&&navigator.msPointerEnabled&&a[t]?l[n](a[t],r):o[t]&&l[n](o[t],r),l[n](t,r)}function a(){return!1}function l(){return!0}function c(e,n){return T(e)?e:e.length?Array.prototype.slice.call(e,n):[e]}function u(e){if(e.touches)return e.touches.length;if(e.originalEvent&&e.originalEvent.touches)return e.originalEvent.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;var n=e.button;return void 0!==n?1&n?1:2&n?3:4&n?2:0:void 0}function s(e){e.originalEvent&&(e=e.originalEvent),t.grabbed&&e.preventDefault()}function d(e,n){return"undefined"!=typeof window[n]?window[n]:w.clientHeight?w[e]:O.body[e]}function m(e){var n=e.getBoundingClientRect(),t=d("scrollTop","pageYOffset"),r=d("scrollLeft","pageXOffset");return{left:n.left+r,right:n.right+r,top:n.top+t,bottom:n.bottom+t}}function f(e){return e.width||e.right-e.left}function g(e){return e.height||e.bottom-e.top}function p(){return[]}function v(e){function n(){var n=e;do n=n.nextSibling;while(n&&1!==n.nodeType);return n}if(e)return e.nextElementSibling||n()}function h(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}function x(e){var n=t.classesCache[e];return n?n.lastIndex=0:t.classesCache[e]=n=new RegExp("(?:^|\\s)"+e+"(?:\\s|$)","g"),n}function y(e,n){var t=e.className;t.length?x(n).test(t)||(e.className+=" "+n):e.className=n}function C(e,n){e.className=e.className.replace(x(n)," ").trim()}function M(e){return e.targetTouches&&e.targetTouches.length?e.targetTouches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e}function b(e,n){var t=M(n),r={pageX:"clientX",pageY:"clientY"};return e in r&&!(e in t)&&r[e]in t&&(e=r[e]),!t.type||t.type.indexOf("touch")<0?t[e]:t.type.indexOf("end")===-1&&t.originalEvent.touches[0][e.replace("client","page")]}function E(e){return e.parentNode===document?null:e.parentNode}function S(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||I(e)}function I(e){return!!e&&("false"!==e.contentEditable&&("true"===e.contentEditable||I(E(e))))}function N(e,n){return Array.prototype.indexOf.call(angular.element(n).children(),e)}function X(e,n,r){e&&(t.extra=r,e.dispatchEvent?e.dispatchEvent(n):e.fireEvent("on"+n.eventType,n))}function Y(e,n,r){return B(e)?!!e.apply(r||this,n||t):!!e}var O=document,w=O.documentElement,T=Array.isArray,B=angular.isFunction;return r.cleanEnviroment=function(){t.classesCache={},t.containersCtx={},t.containers={},t.mirror=void 0},r.shared=t,r};r.$inject=["$rootScope","$compile"],e.exports=r}])});
//# sourceMappingURL=dragular.min.js.map
